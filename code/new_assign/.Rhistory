# highest <- hit_table[hit_table$`%_identity`]
max_id <- function(seq_id){
max(hit_table[hit_table$seq_num == seq_id,"%_identity"])
}
highest_id <- data.frame()
# hit_table[hit_table$seq_num == 2 & hit_table$`%_identity` >= max_id(2),]
for (i in 1:10) {
highest_id <- rbind(highest_id, hit_table[hit_table$seq_num == i & hit_table$`%_identity` >= max_id(i),])
}
highest_id
# highest <- hit_table[hit_table$`%_identity`]
View(highest_id)
max_id <- function(seq_id){
max(hit_table[hit_table$seq_num == seq_id,"%_identity"])
}
highest_id <- data.frame()
# hit_table[hit_table$seq_num == 2 & hit_table$`%_identity` >= max_id(2),]
for (i in 1:max(hit_table$seq_num)) {
highest_id <- rbind(highest_id, hit_table[hit_table$seq_num == i & hit_table$`%_identity` >= max_id(i),])
}
highest_id
# highest <- hit_table[hit_table$`%_identity`]
highest_id <- highest_id[highest_id$`%_identity` > 90]
max_id <- function(seq_id){
max(hit_table[hit_table$seq_num == seq_id,"%_identity"])
}
highest_id <- data.frame()
# hit_table[hit_table$seq_num == 2 & hit_table$`%_identity` >= max_id(2),]
for (i in 1:max(hit_table$seq_num)) {
highest_id <- rbind(highest_id, hit_table[hit_table$seq_num == i & hit_table$`%_identity` >= max_id(i),])
}
highest_id
highest_id <- highest_id[highest_id$`%_identity` > 90,]
highest_id <- highest_id[highest_id$`%_identity` < 90,]
max_id <- function(seq_id){
max(hit_table[hit_table$seq_num == seq_id,"%_identity"])
}
highest_id <- data.frame()
# hit_table[hit_table$seq_num == 2 & hit_table$`%_identity` >= max_id(2),]
for (i in 1:max(hit_table$seq_num)) {
highest_id <- rbind(highest_id, hit_table[hit_table$seq_num == i & hit_table$`%_identity` >= max_id(i),])
}
highest_id
highest_id <- highest_id[highest_id$`%_identity` < 90,]
highest_id
max_id <- function(seq_id){
max(hit_table[hit_table$seq_num == seq_id,"%_identity"])
}
highest_id <- data.frame()
# hit_table[hit_table$seq_num == 2 & hit_table$`%_identity` >= max_id(2),]
for (i in 1:max(hit_table$seq_num)) {
highest_id <- rbind(highest_id, hit_table[hit_table$seq_num == i & hit_table$`%_identity` >= max_id(i),])
}
highest_id
highest_id <- highest_id[highest_id$`%_identity` < 90,]
highest_id
hit_table2 <- read.csv('../../data/new_assign/HitTable2.csv', header = F,
col.names = c("seq_num", "seq_id", "%_identity", "alignment_length", "mismatches", "gap_opens", "q.start", "q.end", "s.start", "s.end", "evalue", "bit_score"))
hit_table2
View(hit_table2)
min_eval <- function(seq_id){
min(hit_table[hit_table$seq_num == seq_id,"evalue"])
}
identified <- data.frame()
# hit_table[hit_table$seq_num == 2 & hit_table$`%_identity` >= max_id(2),]
for (i in 1:max(hit_table$seq_num)) {
identified <- rbind(identified, hit_table[hit_table$seq_num == i & hit_table$`%_identity` == min_eval(i),])
}
identified
#
# identified <- highest_id[highest_id$`%_identity` < 90,]
#
# highest_id
min(hit_table2$evalue)
max(hit_table2$evalue)
min_eval <- function(seq_id){
min(hit_table[hit_table$seq_num == seq_id,"evalue"])
}
max(hit_table2$evalue)
identified <- data.frame()
# hit_table[hit_table$seq_num == 2 & hit_table$`%_identity` >= max_id(2),]
for (i in unique(hit_table2$seq_num)) {
identified <- rbind(identified, hit_table[hit_table$seq_num == i & hit_table$`%_identity` == min_eval(i),])
}
identified
#
# identified <- highest_id[highest_id$`%_identity` < 90,]
#
# highest_id
min_eval <- function(seq_id){
min(hit_table[hit_table$seq_num == seq_id,"evalue"])
}
max(hit_table2$evalue)
identified <- data.frame()
# hit_table[hit_table$seq_num == 2 & hit_table$`%_identity` >= max_id(2),]
for (i in unique(hit_table2$seq_num)) {
identified <- rbind(identified, hit_table[hit_table$seq_num == i & hit_table$evalue == min_eval(i),])
}
identified
#
# identified <- highest_id[highest_id$`%_identity` < 90,]
#
# highest_id
View(identified)
hit_table2[hit_table2$evalue == 5.76e-100]
hit_table2[hit_table2$evalue == 5.76e-100]
hit_table2[hit_table2$evalue == 5.76e-100,]
min(hit_table2$evalue)
min_eval <- function(seq_id){
min(hit_table[hit_table$seq_num == seq_id,"evalue"])
}
min(hit_table2$evalue)
identified <- data.frame()
# hit_table[hit_table$seq_num == 2 & hit_table$`%_identity` >= max_id(2),]
for (i in unique(hit_table2$seq_num)) {
identified <- rbind(identified, hit_table2[hit_table2$seq_num == i & hit_table2$evalue == min_eval(i),])
}
# problem, the new table is fucked up
hit_table2[hit_table2$evalue == 5.76e-100,]
identified
#
# identified <- highest_id[highest_id$`%_identity` < 90,]
#
# highest_id
min_eval <- function(seq_id){
min(hit_table[hit_table$seq_num == seq_id,"evalue"])
}
min(hit_table2$evalue)
identified <- data.frame()
# hit_table[hit_table$seq_num == 2 & hit_table$`%_identity` >= max_id(2),]
for (i in unique(hit_table2$seq_num)) {
identified <- rbind(identified, hit_table2[hit_table2$seq_num == i & hit_table2$evalue == min_eval(i),])
}
# problem, the new table is fucked up
# hit_table2[hit_table2$evalue == 5.76e-100,]
identified
#
# identified <- highest_id[highest_id$`%_identity` < 90,]
#
# highest_id
min_eval <- function(seq_id){
min(hit_table[hit_table$seq_num == seq_id,"evalue"])
}
min(hit_table2$evalue)
identified <- data.frame()
# hit_table[hit_table$seq_num == 2 & hit_table$`%_identity` >= max_id(2),]
for (i in unique(hit_table2$seq_num)) {
# identified <- rbind(identified, hit_table2[hit_table2$seq_num == i & hit_table2$evalue == min_eval(i),])
print(i)
}
# problem, the new table is fucked up
# hit_table2[hit_table2$evalue == 5.76e-100,]
identified
#
# identified <- highest_id[highest_id$`%_identity` < 90,]
#
# highest_id
#
# identified <- highest_id[highest_id$`%_identity` < 90,]
#
# highest_id
hit_table2[hit_table2$seq_num == 2.52e-180]
#
# identified <- highest_id[highest_id$`%_identity` < 90,]
#
# highest_id
print(hit_table2[hit_table2$seq_num == 2.52e-180,])
for (i in unique(hit_table2$seq_num)) {
# identified <- rbind(identified, hit_table2[hit_table2$seq_num == i & hit_table2$evalue == min_eval(i),])
print(i)
}
min_eval <- function(seq_id){
min(hit_table[hit_table$seq_num == seq_id,"evalue"])
}
# min(hit_table2$evalue)
identified <- data.frame()
# hit_table[hit_table$seq_num == 2 & hit_table$`%_identity` >= max_id(2),]
for (i in unique(hit_table2$seq_num)) {
# identified <- rbind(identified, hit_table2[hit_table2$seq_num == i & hit_table2$evalue == min_eval(i),])
print(i)
}
# problem, the new table is fucked up
# hit_table2[hit_table2$evalue == 5.76e-100,]
identified
#
# identified <- highest_id[highest_id$`%_identity` < 90,]
#
# highest_id
hit_table2[hit_table2$seq_num == 1 & hit_table2$evalue == min_eval(1),]
hit_table2[hit_table2$seq_num == 2  & hit_table2$evalue == min_eval(2),]
min_eval(2)
min_eval <- function(seq_id){
hit_table[hit_table$seq_num == seq_id,"evalue"]
}
min_eval(2)
length(min_eval(2))
min_eval <- function(seq_id){
hit_table2[hit_table2$seq_num == seq_id,"evalue"]
}
length(min_eval(2))
min_eval <- function(seq_id){
min(hit_table2[hit_table2$seq_num == seq_id,"evalue"])
}
identified <- data.frame()
for (i in unique(hit_table2$seq_num)) {
# identified <- rbind(identified, hit_table2[hit_table2$seq_num == i & hit_table2$evalue == min_eval(i),])
print(i)
}
identified
min_eval <- function(seq_id){
min(hit_table2[hit_table2$seq_num == seq_id,"evalue"])
}
# min(hit_table2$evalue)
identified <- data.frame()
# hit_table[hit_table$seq_num == 2 & hit_table$`%_identity` >= max_id(2),]
for (i in unique(hit_table2$seq_num)) {
identified <- rbind(identified, hit_table2[hit_table2$seq_num == i & hit_table2$evalue == min_eval(i),])
print(i)
}
# problem, the new table is fucked up
# hit_table2[hit_table2$evalue == 5.76e-100,]
identified
#
# identified <- highest_id[highest_id$`%_identity` < 90,]
#
# highest_id
# min_eval(2)
#
# hit_table2[hit_table2$seq_num == 2  & hit_table2$evalue == min_eval(2),]
View(identified)
min_eval <- function(seq_id){
min(hit_table2[hit_table2$seq_num == seq_id,"evalue"])
}
identified <- data.frame()
for (i in unique(hit_table2$seq_num)) {
identified <- rbind(identified, hit_table2[hit_table2$seq_num == i & hit_table2$evalue == min_eval(i),])
print(i)
}
identified
unique(identified$seq_id)
length(unique(identified$seq_id))
unique(identified$seq_id)
hit_table2 <- read.csv('../../data/new_assign/HitTable2.csv', header = F,
col.names = c("seq_num", "seq_id", "%_identity", "alignment_length", "mismatches", "gap_opens", "q.start", "q.end", "s.start", "s.end", "evalue", "bit_score"))
hit_table2
min_eval <- function(seq_id){
min(hit_table2[hit_table2$seq_num == seq_id,"evalue"])
}
identified <- data.frame()
for (i in unique(hit_table2$seq_num)) {
identified <- rbind(identified, hit_table2[hit_table2$seq_num == i & hit_table2$evalue == min_eval(i),])
print(i)
}
unique(identified$seq_id)
length(unique(identified$seq_id))
min_eval <- function(seq_id){
min(hit_table2[hit_table2$seq_num == seq_id,"evalue"])
}
identified <- data.frame()
for (i in unique(hit_table2$seq_num)) {
identified <- rbind(identified, hit_table2[hit_table2$seq_num == i & hit_table2$evalue == min_eval(i),])
print(i)
}
# unique(identified$seq_id)
length(unique(identified$seq_id))
min_eval <- function(seq_id){
min(hit_table2[hit_table2$seq_num == seq_id,"evalue"])
}
identified <- data.frame()
for (i in unique(hit_table2$seq_num)) {
identified <- rbind(identified, hit_table2[hit_table2$seq_num == i & hit_table2$evalue == min_eval(i),])
print(i)
}
unique(identified$seq_id)
# length(unique(identified$seq_id))
min_eval <- function(seq_id){
min(hit_table2[hit_table2$seq_num == seq_id,"evalue"])
}
identified <- data.frame()
for (i in unique(hit_table2$seq_num)) {
identified <- rbind(identified, hit_table2[hit_table2$seq_num == i & hit_table2$evalue == min_eval(i),])
print(i)
}
unique(identified$seq_id)
# length(unique(identified$seq_id))
min_eval <- function(seq_id){
min(hit_table2[hit_table2$seq_num == seq_id,"evalue"])
}
identified <- data.frame()
for (i in unique(hit_table2$seq_num)) {
identified <- rbind(identified, hit_table2[hit_table2$seq_num == i & hit_table2$evalue == min_eval(i),])
# print(i)
}
unique(identified$seq_id)
# length(unique(identified$seq_id))
hit_table2 <- read.csv('../../data/new_assign/HitTable2.csv', header = F,
col.names = c("seq_num", "seq_id", "%_identity", "alignment_length", "mismatches", "gap_opens", "q.start", "q.end", "s.start", "s.end", "evalue", "bit_score"))
hit_table2
min_eval <- function(seq_id){
min(hit_table2[hit_table2$seq_num == seq_id,"evalue"])
}
identified <- data.frame()
for (i in unique(hit_table2$seq_num)) {
identified <- rbind(identified, hit_table2[hit_table2$seq_num == i & hit_table2$evalue == min_eval(i),])
# print(i)
}
unique(identified$seq_id)
# length(unique(identified$seq_id))
View(identified)
table(identified$seq_num)
dim(table(identified$seq_num))
table(identified$seq_num) >1
table(identified$seq_num)[table(identified$seq_num) > 1]
table(identified$seq_num)[table(identified$seq_num) > 1]
length(table(identified$seq_num)[table(identified$seq_num) > 1])
min_eval <- function(seq_id){
min(hit_table2[hit_table2$seq_num == seq_id,"evalue"])
}
identified <- data.frame()
for (i in unique(hit_table2$seq_num)) {
identified <- rbind(identified, hit_table2[hit_table2$seq_num == i & hit_table2$evalue == min_eval(i),])
# print(i)
}
unique(identified$seq_id)
# length(unique(identified$seq_id))
hit_table2 <- read.csv('../../data/new_assign/HitTable2.csv', header = F,
col.names = c("seq_num", "seq_id", "%_identity", "alignment_length", "mismatches", "gap_opens", "q.start", "q.end", "s.start", "s.end", "evalue", "bit_score"))
hit_table2
length(unique(identified$seq_id))
min_eval <- function(seq_id){
min(hit_table2[hit_table2$seq_num == seq_id,"evalue"])
}
identified <- data.frame()
for (i in unique(hit_table2$seq_num)) {
identified <- rbind(identified, hit_table2[hit_table2$seq_num == i & hit_table2$evalue == min_eval(i),])
# print(i)
}
unique(identified$seq_id)
length(unique(identified$seq_id))
length(unique(identified$seq_num))
min_eval <- function(seq_id){
min(hit_table2[hit_table2$seq_num == seq_id,"evalue"])
}
identified <- data.frame()
for (i in unique(hit_table2$seq_num)) {
identified <- rbind(identified, hit_table2[hit_table2$seq_num == i & hit_table2$evalue == min_eval(i),])
# print(i)
}
unique(identified$seq_id)
length(unique(identified$seq_id))
length(unique(identified$seq_num)) # only half of it would be annotated
length(unique(identified$seq_num)) # only half of it would be annotated
min_eval <- function(seq_id){
min(hit_table2[hit_table2$seq_num == seq_id,"evalue"])
}
identified <- data.frame()
for (i in unique(hit_table2$seq_num)) {
identified <- rbind(identified, hit_table2[hit_table2$seq_num == i & hit_table2$evalue == min_eval(i),])
# print(i)
}
unique(identified$seq_id)
length(unique(identified$seq_id))
length(unique(identified$seq_num)) # only half of it would be annotated
hit_table2 <- read.csv('../../data/new_assign/HitTable2.csv', header = F,
col.names = c("seq_num", "seq_id", "%_identity", "alignment_length", "mismatches", "gap_opens", "q.start", "q.end", "s.start", "s.end", "evalue", "bit_score"))
hit_table2
min_eval <- function(seq_id){
min(hit_table2[hit_table2$seq_num == seq_id,"evalue"])
}
identified <- data.frame()
for (i in unique(hit_table2$seq_num)) {
identified <- rbind(identified, hit_table2[hit_table2$seq_num == i & hit_table2$evalue == min_eval(i),])
# print(i)
}
unique(identified$seq_id)
length(unique(identified$seq_id))
length(unique(identified$seq_num)) # only half of it would be annotated
View(hit_table2)
hit_table2 <- read.csv('../../data/new_assign/HitTable2.csv', header = F,
col.names = c("seq_num", "seq_id", "%_identity", "alignment_length", "mismatches", "gap_opens", "q.start", "q.end", "s.start", "s.end", "evalue", "bit_score"))
hit_table2
min_eval <- function(seq_id){
min(hit_table2[hit_table2$seq_num == seq_id,"evalue"])
}
identified <- data.frame()
for (i in unique(hit_table2$seq_num)) {
identified <- rbind(identified, hit_table2[hit_table2$seq_num == i & hit_table2$evalue == min_eval(i),])
# print(i)
}
unique(identified$seq_id)
length(unique(identified$seq_id))
length(unique(identified$seq_num)) # only half of it would be annotated
min(hit_table2$X._identity)
))
length(unique(identified$seq_id))
length(unique(hit_table2$seq_id))
unique(identified$seq_id)
install.packages("biomartr")
# download the genome of Homo sapiens from refseq
# and store the corresponding genome file in '_ncbi_downloads/genomes'
HS.genome.refseq <- getGenome( db       = "refseq",
organism = "Homo sapiens")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("biomaRt")
library(biomaRt)
library(biomaRt)
# download the genome of Homo sapiens from refseq
# and store the corresponding genome file in '_ncbi_downloads/genomes'
HS.genome.refseq <- getGenome( db       = "refseq",
organism = "Homo sapiens")
hit_table <- read.csv('../../data/new_assign/HitTable2.csv', header = F,
col.names = c("seq_num", "seq_id", "%_identity", "alignment_length", "mismatches", "gap_opens", "q.start", "q.end", "s.start", "s.end", "evalue", "bit_score"))
hit_table <- read.csv('../../data/new_assign/HitTable2.csv', header = F,
col.names = c("seq_num", "seq_id", "%_identity", "alignment_length", "mismatches", "gap_opens", "q.start", "q.end", "s.start", "s.end", "evalue", "bit_score"))
hit_table <- read.csv('../../data/new_assign/HitTable.csv', header = F,
col.names = c("seq_num", "seq_id", "%_identity", "alignment_length", "mismatches", "gap_opens", "q.start", "q.end", "s.start", "s.end", "evalue", "bit_score"))
hit_table
hit_table <- read.csv('../../data/new_assign/HitTable.csv', header = F,
col.names = c("seq_num", "seq_id", "%_identity", "alignment_length", "mismatches", "gap_opens", "q.start", "q.end", "s.start", "s.end", "evalue", "bit_score"))
hit_table
hit_table <- read.csv('../../data/new_assign/HitTable.csv', header = F,
col.names = c("seq_num", "seq_id", "percent_identity", "alignment_length", "mismatches", "gap_opens", "q.start", "q.end", "s.start", "s.end", "evalue", "bit_score"))
hit_table
min_eval <- function(seq_id){
min(hit_table[hit_table$seq_num == seq_id,"evalue"])
}
identified <- data.frame()
for (i in unique(hit_table$seq_num)) {
identified <- rbind(identified, hit_table[hit_table$seq_num == i & hit_table$evalue == min_eval(i),])
# print(i)
}
unique(identified$seq_id)
length(unique(identified$seq_id))
length(unique(hit_table$seq_id))
length(unique(identified$seq_num)) # only half of it would be annotated
min(hit_table$X._identity)
library(biomaRt)
# download the genome of Homo sapiens from refseq
# and store the corresponding genome file in '_ncbi_downloads/genomes'
HS.genome.refseq <- getGenome( db       = "refseq",
organism = "Homo sapiens")
min_eval <- function(seq_id){
min(hit_table[hit_table$seq_num == seq_id,"evalue"])
}
identified <- data.frame()
for (i in unique(hit_table$seq_num)) {
identified <- rbind(identified, hit_table[hit_table$seq_num == i & hit_table$evalue == min_eval(i),])
# print(i)
}
unique(identified$seq_id)
#
# length(unique(identified$seq_id))
# length(unique(hit_table$seq_id))
# length(unique(identified$seq_num)) # only half of it would be annotated
#
# min(hit_table$X._identity)
unique(hit_table$seq_id)
unique(identified$seq_id)/unique(hit_table$seq_id)
length(unique(identified$seq_id))/length(unique(hit_table$seq_id))*100
length(unique(identified$seq_id))/length(unique(hit_table$seq_id))*100
unique(hit_table$seq_id)
# function to get the smallest e-val depending on the sequence
min_eval <- function(seq_id){
min(hit_table[hit_table$seq_num == seq_id,"evalue"])
}
# Gather it in a df with the smallest with the smallest e-val for the sequences
identified <- data.frame()
for (i in unique(hit_table$seq_num)) {
identified <- rbind(identified, hit_table[hit_table$seq_num == i & hit_table$evalue == min_eval(i),])
# print(i)
}
# Get all the unique id of the best matching sequences (around 4-5% of all the matching sequences)
unique(identified$seq_id)
# If we say that all the found sequences are relevant, then we can just omit the previous step and obtain
unique(hit_table$seq_id)
# Percent of the kept sequences in the first case:
length(unique(hit_table$seq_id))/length(unique(identified$seq_id))*100
library(biomaRt)
# download the genome of Homo sapiens from refseq
# and store the corresponding genome file in '_ncbi_downloads/genomes'
HS.genome.refseq <- getGenome( db       = "refseq",
organism = "Homo sapiens")
library(biomaRt)
ensembl <- useEnsembl(biomart = "genes", dataset = "hsapiens_gene_ensembl")
View(ensembl)
class(ensembl)
listEnsembl()
hit_table <- read.csv('../../data/new_assign/HitTable.csv', header = F,
col.names = c("seq_num", "seq_id", "percent_identity", "alignment_length", "mismatches", "gap_opens", "q.start", "q.end", "s.start", "s.end", "evalue", "bit_score"))
hit_table
# function to get the smallest e-val depending on the sequence
min_eval <- function(seq_id){
min(hit_table[hit_table$seq_num == seq_id,"evalue"])
}
# Gather it in a df with the smallest with the smallest e-val for the sequences (not optimized at all because for loop but easier to read)
identified <- data.frame()
for (i in unique(hit_table$seq_num)) {
identified <- rbind(identified, hit_table[hit_table$seq_num == i & hit_table$evalue == min_eval(i),])
# print(i)
}
# Get all the unique id of the best matching sequences (around 4-5% of all the matching sequences)
unique(identified$seq_id)
# If we say that all the found sequences are relevant, then we can just omit the previous step and obtain
unique(hit_table$seq_id)
# Percent of the kept sequences in the first case:
length(unique(hit_table$seq_id))/length(unique(identified$seq_id))*100
library(biomaRt)
# download the genome of Homo sapiens from refseq
# and store the corresponding genome file in '_ncbi_downloads/genomes'
HS.genome.refseq <- getGenome( db       = "refseq",
organism = "Homo sapiens")
