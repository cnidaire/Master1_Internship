---
title: "Untitled"
author: "RÃ©mi Legrand"
date: "2023-04-18"
output: html_document
---

Need tidyverse package!!!

Using tidyverse, it takes less than a second to do 30K sequences

```{r}

setwd("../data")
getwd()
non_classified <- read.csv("non_classified_nifh.csv", header = T, sep = ",")

library(tidyverse)

csv_to_fasta <- function(data){
  table <- tibble(id = paste(">", non_classified$index, " ", non_classified$tax, sep = ""), 
                  seq = non_classified$seq)
  return(separate_rows(unite(table, id, seq, col = "sequence",sep = ","), sequence, sep = ","))
}

fasta_file <- as.list(csv_to_fasta(non_classified))
# length(fasta_file)
# fasta_file$sequence

setwd("../data")
fileConn<-file("test1.fasta")
writeLines(fasta_file$sequence, fileConn)
close(fileConn)
```
